<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECS Timeline Builder</title>
    <link rel="stylesheet" href="css/timeline.css">
    <script src="lib/d3.v7.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Full-page Timeline Background -->
        <div id="timeline-container" class="timeline-container">
            <svg id="timeline-svg"></svg>
        </div>

        <!-- Floating Input Bar -->
        <div class="floating-input" id="floating-input">
            <div class="input-drop-zone" id="drop-zone" title="Drop JSON files or click to browse">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <path fill="currentColor" d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z"/>
                </svg>
                <span>Drop files</span>
                <input type="file" id="file-input" accept=".json,.ndjson" multiple hidden>
            </div>
            <textarea id="json-input" placeholder="Paste ECS JSON here..."></textarea>
            <button id="parse-btn" class="btn-icon" title="Parse Events">
                <svg viewBox="0 0 24 24" width="20" height="20">
                    <path fill="currentColor" d="M8 5v14l11-7z"/>
                </svg>
            </button>
        </div>

        <!-- Floating Zoom Controls -->
        <div class="floating-zoom" id="floating-zoom">
            <button id="zoom-in" class="btn-icon" title="Zoom In">
                <svg viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
            </button>
            <button id="zoom-out" class="btn-icon" title="Zoom Out">
                <svg viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M19 13H5v-2h14v2z"/>
                </svg>
            </button>
            <button id="zoom-reset" class="btn-icon" title="Reset Zoom">
                <svg viewBox="0 0 24 24" width="18" height="18">
                    <path fill="currentColor" d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/>
                </svg>
            </button>
        </div>

        <!-- Floating Left Sidebar -->
        <aside class="floating-sidebar" id="sidebar">
            <!-- Header with toggle and title -->
            <div class="sidebar-header">
                <button class="sidebar-toggle" id="sidebar-toggle" title="Toggle Sidebar">
                    <svg viewBox="0 0 24 24" width="20" height="20" class="icon-expand">
                        <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                    </svg>
                    <svg viewBox="0 0 24 24" width="20" height="20" class="icon-collapse">
                        <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                    </svg>
                </button>
                <span class="sidebar-title">ECS Timeline</span>
            </div>

            <!-- Stats Section -->
            <div class="sidebar-section" data-section="stats">
                <div class="section-icon" title="Statistics">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M5 9.2h3V19H5V9.2zM10.6 5h2.8v14h-2.8V5zm5.6 8H19v6h-2.8v-6z"/>
                    </svg>
                </div>
                <div class="section-content">
                    <div class="sidebar-section-title">Statistics</div>
                    <div class="stat-row">
                        <span class="stat-label">Events</span>
                        <span class="stat-value" id="stat-events">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Hosts</span>
                        <span class="stat-value" id="stat-hosts">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Connections</span>
                        <span class="stat-value" id="stat-connections">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Time Span</span>
                        <span class="stat-value" id="stat-timespan">-</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">Users Online</span>
                        <span class="stat-value" id="stat-users">-</span>
                    </div>
                </div>
            </div>

            <!-- Filters Section -->
            <div class="sidebar-section" data-section="filters">
                <div class="section-icon" title="Filters">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
                    </svg>
                </div>
                <div class="section-content">
                    <div class="sidebar-section-title">Filters</div>
                    <label class="filter-row">
                        <input type="checkbox" id="filter-network" checked>
                        <span class="filter-color" style="background: var(--color-network)"></span>
                        <span>Network</span>
                    </label>
                    <label class="filter-row">
                        <input type="checkbox" id="filter-file" checked>
                        <span class="filter-color" style="background: var(--color-file)"></span>
                        <span>File</span>
                    </label>
                    <label class="filter-row">
                        <input type="checkbox" id="filter-process" checked>
                        <span class="filter-color" style="background: var(--color-process)"></span>
                        <span>Process</span>
                    </label>
                    <label class="filter-row">
                        <input type="checkbox" id="filter-auth" checked>
                        <span class="filter-color" style="background: var(--color-auth)"></span>
                        <span>Auth</span>
                    </label>
                    <label class="filter-row">
                        <input type="checkbox" id="filter-other" checked>
                        <span class="filter-color" style="background: var(--color-other)"></span>
                        <span>Other</span>
                    </label>
                </div>
            </div>

            <!-- Actions Section -->
            <div class="sidebar-section" data-section="actions">
                <div class="section-icon section-icon-actions" title="Actions">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                    </svg>
                </div>
                <div class="section-content">
                    <div class="sidebar-section-title">Actions</div>
                    <button id="export-btn" class="sidebar-btn" disabled>
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <path fill="currentColor" d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                        </svg>
                        <span>Export</span>
                    </button>
                    <button id="clear-btn" class="sidebar-btn" disabled>
                        <svg viewBox="0 0 24 24" width="16" height="16">
                            <path fill="currentColor" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                        </svg>
                        <span>Clear</span>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Event Detail Panel (Right Side) -->
        <aside id="event-detail" class="floating-detail" hidden>
            <div class="detail-header">
                <h3>Event Details</h3>
                <button id="close-detail" class="btn-icon" title="Close">
                    <svg viewBox="0 0 24 24" width="20" height="20">
                        <path fill="currentColor" d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                    </svg>
                </button>
            </div>
            <div id="detail-content" class="detail-content"></div>
        </aside>
    </div>
    <script type="module" src="js/app.js"></script>
</body>
</html>
